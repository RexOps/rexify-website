<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html content="text/html; charset=utf-8" content-type" prefix="og: http://ogp.me/ns#" xml:lang="en&gt;
   &lt;head&gt;
      &lt;meta http-equiv=" xmlns="http://www.w3.org/1999/xhtml">

      <title>FAQ</title>

      <meta content="FAQ" property="og:title">
      <meta content="website" property="og:type">
      <meta content="https://rexify.org/docs/faq/" property="og:url">
      <meta content="https://rexify.org/public/images/skin/rexify.org/favicon.png" property="og:image">

      <meta content="width=1024, initial-scale=0.5" name="viewport">
      <link href="/public/images/skin/rexify.org/favicon.png" rel="shortcut icon">
      <link href="/public/css/skin/rexify.org/hs/tomorrow.css" rel="stylesheet">
      <link charset="utf-8" href="/public/css/skin/rexify.org/bootstrap.min.css?20130325" media="screen" rel="stylesheet" type="text/css">
      <link charset="utf-8" href="/public/css/skin/rexify.org/default.css?20140412" media="screen" rel="stylesheet" type="text/css">
      <meta content="" name="description">
      <meta content="" name="keywords">

   
   <body>

      <div id="page">

         <div class="top_div" id="top-div">
            <h1>(R)?ex <small>Deployment &amp; Configuration Management</small></h1>
            <div id="nav-div">
               
<div class="nav_links">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/get/index.html">Get Rex</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/care/index.html">Care</a>
      <ul class="dropdown_menu dropdown_care">
          <li><a href="/care/help__r__ex.html">Help (R)?ex</a></li>
          <li><a href="/care/help_people_in_need.html">Help people</a></li>
      </ul>
    </li>
    <li><a href="/support/index.html">Support</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/docs/index.html">Docs</a>
      <ul class="dropdown_menu dropdown_docs">
          <li><a href="/docs/faq/index.html">FAQ</a></li>
          <li><a href="/docs/guides/index.html">Guides</a></li>
          <li><a href="/docs/rex_book/index.html">Rex Book (work in progress)</a></li>
          <li><a href="/docs/release_notes/index.html">Release notes</a></li>
            <li class="divider"></li>
          <li><a href="https://metacpan.org/release/Rex">API</a></li>
      </ul>
    </li>
  </ul>
</div>

            </div>
            </div>
         </div>

         <div id="widgets_container">
            <div id="widgets">
               <h2>News</h2>
                   <p><b>2019-07-02</b><br>
                     <a href="/blog/2019/07/02/deprecating_official_rex_packages.html">Deprecating official Rex packages</a></p><p>
                   </p><p></p><p>As part of our efforts to simplify maintenance around RexOps projects, we have decided to stop building Rex packages on our side. We recommend relying on OS packages maintained by the various distributions in their respective upstream repositories, or to install Rex from CPAN.</p>

                   <p><b>2019-06-09</b><br>
                     <a href="/blog/2019/06/09/site-update.html">Post-migration updates &amp; clean-up</a></p><p>
                   </p><p></p><p>Over the course of the past weeks many clean-ups have been
done, reaping the benefits provided by our new
<a href="http://preaction.me/statocles">Statocles</a>-based site:</p>

                   <p><b>2019-05-19</b><br>
                     <a href="/blog/2019/05/19/new-site.html">New site engine for rexify.org</a></p><p>
                   </p><p></p><p>After months of work on a new site backend, we reached the MVP today for
our site to be switched over to a new engine: from now on, our site will be
maintained using the static site generator
<a href="http://preaction.me/statocles/">Statocles</a>.</p>


               <h2>Conferences</h2>
                 <div class="news_widget">
                    <div class="news_date">2016-06-21</div>
                    <div class="news_content"><a href="http://preaction.me/">Doug Bell (preaction)</a> from <a href="http://chicago.pm.org/">Chicago.pm</a> will give an <a href="http://www.yapcna.org/yn2016/talk/6549">Introduction to Rex</a> talk at <a href="http://www.yapcna.org/yn2016/">YAPC::NA 2016</a>.</div>
                 </div>

               <h2>Need Help?</h2>
               <p>Rex is a pure open source project, you can find community support in the following places:</p>
               <ul>
                  <li>IRC: <a href="irc://irc.freenode.net/rex">#rex on irc.freenode.net</a></li>
                  <li>Groups: <a href="https://groups.google.com/group/rex-users/">Rex Users</a></li>
                  <li>Serverfault: <a href="http://serverfault.com/questions/tagged/rex">Tag with <i>rex</i></a></li>
                  <li>Issues: <a href="https://github.com/RexOps/Rex/issues">on GitHub</a></li>
                  <li>Feature: you miss a <a href="/feature.html">feature</a>?</li>
               </ul>
               <p><a href="/support/index.html">Professional support</a> is also available.</p>
            </div>
         </div> <!-- widgets -->

         <div id="content_container">
            <div id="content">
              




<p>
» <a href="/index.html">Home</a>
» <a href="/docs/index.html">Docs</a>
» <a href="/docs/faq/index.html">FAQ</a>
</p>

              
              <h1>FAQ</h1>
              <p>Here we will maintain a list of frequently asked questions with their answers.</p>

<ul>
<li><a href="#whydoestheruncommandnotformattheoutput">Why does the run command not format the output?</a></li>
<li><a href="#howcanigetthecurrentserverfromwithinatask">How can I get the current server from within a task?</a></li>
<li><a href="#howcanipassparameterstoatask">How can I pass parameters to a task?</a></li>
<li><a href="#howcanirunablockofcodewithonecommand">How can I run a block of code with one command?</a></li>
<li><a href="#howcanirunalocalscriptontheremote">How can I run a local script on the remote?</a></li>
<li><a href="#howdoirunalocalscriptontheremoteunderadifferentuser">How do I run a local script on the remote under a different user?</a></li>
<li><a href="#howdoichecktheexitstatusofaremotelyruncommand">How do I check the exit status of a remotely run command?</a></li>
<li><a href="#howdoiuserexsbuilt-inloggerforerrorwarninfodebugmessages">How do I use Rex&#39;s built-in logger for ERROR/WARN/INFO/DEBUG messages?</a></li>
</ul>

<h2 id="whydoestheruncommandnotformattheoutput">Why does the run command not format the output?</h2>

<p>The run command - called in array context - will return an array.</p>

<p>If you want to print the output to your terminal you have to call it in a scalar context.</p>

<pre><code class="hljs">⁠<span class="hljs-keyword">my</span> <span class="hljs-type">$output</span> = run &quot;<span class="hljs-string">df -h</span>&quot;;
⁠say <span class="hljs-type">$output</span>;</code></pre>

<h2 id="howcanigetthecurrentserverfromwithinatask">How can I get the current server from within a task?</h2>

<pre><code class="hljs">⁠<span class="hljs-keyword">my</span> <span class="hljs-type">$current_server</span> = connection-&gt;server;</code></pre>

<h2 id="howcanipassparameterstoatask">How can I pass parameters to a task?</h2>

<pre><code class="hljs">⁠task &#39;<span class="hljs-string">mytask</span>&#39;, <span class="hljs-keyword">sub </span>{
⁠  <span class="hljs-keyword">my</span> <span class="hljs-type">$parameters</span>       = <span class="hljs-function">shift</span>;
⁠  <span class="hljs-keyword">my</span> <span class="hljs-type">$parameter1_value</span> = <span class="hljs-type">$parameters</span>-&gt;{parameter1};
⁠  <span class="hljs-keyword">my</span> <span class="hljs-type">$parameter2_value</span> = <span class="hljs-type">$parameters</span>-&gt;{parameter2};
⁠};</code></pre>

<p>Then you can run mytask from CLI like this:</p>

<pre><code>rex -H hostname mytask --parameter1=value1 --parameter2=value2
</code></pre>

<h2 id="howcanirunablockofcodewithonecommand">How can I run a block of code with one command?</h2>

<p>You can use the ShellBlock module. This module can be installed by running:</p>

<pre><code>$ rexify --use Rex::Misc::ShellBlock
</code></pre>

<p>Then, you can run your shell code remotely as:</p>

<pre><code class="hljs">⁠<span class="hljs-keyword">use</span> <span class="hljs-function">Rex::Misc</span>::<span class="hljs-function">ShellBlock</span>;
⁠
⁠task &quot;<span class="hljs-string">myexec</span>&quot;, <span class="hljs-keyword">sub </span>{
⁠  shell_block &lt;&lt;<span class="hljs-keyword">EOF;</span><span class="hljs-string">
⁠</span><span class="hljs-string">    echo &quot;hi&quot;</span><span class="hljs-string">
⁠</span><span class="hljs-keyword">EOF</span>
⁠};</code></pre>

<p>See the linked documentation page for how to use this module with Perl, Python, or other languages.</p>

<h2 id="howcanirunalocalscriptontheremote">How can I run a local script on the remote?</h2>

<p>If you have a local script &#39;files/script&#39;, you can run it on the remote using the ShellBlock module referred to in the FAQ above. After you install as pointed out above, you can run the script remotely with the command:</p>

<pre><code class="hljs">⁠<span class="hljs-keyword">use</span> <span class="hljs-function">Rex::Misc</span>::<span class="hljs-function">ShellBlock</span>;
⁠task &quot;<span class="hljs-string">myexec</span>&quot;, <span class="hljs-keyword">sub </span>{
⁠  shell_block template(&#39;<span class="hljs-string">files/script</span>&#39;);
⁠};</code></pre>

<h2 id="howdoirunalocalscriptontheremoteunderadifferentuser">How do I run a local script on the remote under a different user?</h2>

<p>Given the same scenario as above, but with the additional requirement to run the script as a different user, the solution looks like below:</p>

<pre><code class="hljs">⁠<span class="hljs-keyword">use</span> <span class="hljs-function">Rex::Misc</span>::<span class="hljs-function">ShellBlock</span>;
⁠task &quot;<span class="hljs-string">myexec</span>&quot;, <span class="hljs-keyword">sub </span>{
⁠  sudo {
⁠    command =&gt; <span class="hljs-keyword">sub </span>{
⁠      shell_block template(&#39;<span class="hljs-string">files/script</span>&#39;);
⁠    },
⁠    user =&gt; &#39;<span class="hljs-string">root</span>&#39;
⁠  };
⁠};</code></pre>

<h2 id="howdoichecktheexitstatusofaremotelyruncommand">How do I check the exit status of a remotely run command?</h2>

<p>Rex assigns the exit code from the remote invocation of <code>run</code> or <code>shell_block</code> statements to the <code>$?</code> variable.</p>

<h2 id="howdoiuserexsbuilt-inloggerforerrorwarninfodebugmessages">How do I use Rex&#39;s built-in logger for ERROR/WARN/INFO/DEBUG messages?</h2>

<pre><code class="hljs">⁠<span class="hljs-function">Rex::Logger</span>::<span class="hljs-function">info</span>(&quot;<span class="hljs-string">some message</span>&quot;); <span class="hljs-comment"># for INFO  (green)</span><span class="hljs-comment">
⁠</span><span class="hljs-function">Rex::Logger</span>::<span class="hljs-function">info</span>( &quot;<span class="hljs-string">some message</span>&quot;, &quot;<span class="hljs-string">warn</span>&quot; );  <span class="hljs-comment"># for WARN  (yellow)</span><span class="hljs-comment">
⁠</span><span class="hljs-function">Rex::Logger</span>::<span class="hljs-function">info</span>( &quot;<span class="hljs-string">some message</span>&quot;, &quot;<span class="hljs-string">error</span>&quot; ); <span class="hljs-comment"># for ERROR (red)</span></code></pre>



            </div>
         </div> <!-- content -->

       <!-- page -->


   <div class="clearfix"></div>
   <div class="bottom_bar">
      <a href="https://groups.google.com/group/rex-users/">Google Group</a> / <a href="http://twitter.com/RexOps">Twitter</a> / <a href="https://github.com/RexOps/Rex">GitHub</a> / <a href="http://www.freelists.org/list/rex-users">Mailinglist</a> / <a href="irc://irc.freenode.net/rex">irc.freenode.net #rex</a>   -.ô.-   <a href="http://www.disclaimer.de/disclaimer.htm" target="_blank">Disclaimer</a>
   </div>

   </body>

</html>
