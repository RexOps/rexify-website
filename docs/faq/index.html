<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html prefix="og: http://ogp.me/ns#" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta content="text/html; charset=utf-8" http-equiv="content-type">

      <title>FAQ</title>

      <meta content="FAQ" property="og:title">
      <meta content="website" property="og:type">
      <meta content="https://rexify.org/docs/faq/" property="og:url">
      <meta content="https://rexify.org/public/images/skin/rexify.org/open_graph.png" property="og:image">

      <meta content="width=1024, initial-scale=0.5" name="viewport">
      <link href="/public/images/skin/rexify.org/favicon.png" rel="shortcut icon">
      <link href="/public/css/skin/rexify.org/hs/tomorrow.css" rel="stylesheet">
      <link charset="utf-8" href="/public/css/skin/rexify.org/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css">
      <link charset="utf-8" href="/public/css/skin/rexify.org/default.css" media="screen" rel="stylesheet" type="text/css">
      <meta content="" name="description">
      <meta content="" name="keywords">

   </head>
   <body>

      <div id="page">

         <div class="top_div" id="top-div">
            <h1>(R)?ex <small>the friendly automation framework</small></h1>
            <div id="nav-div">
               
<div class="nav_links">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/get/index.html">Get Rex</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/care/index.html">Care</a>
      <ul class="dropdown_menu dropdown_care">
          <li><a href="/care/help__r__ex.html">Help (R)?ex</a></li>
          <li><a href="/care/help_people_in_need.html">Help people</a></li>
      </ul>
    </li>
    <li><a href="/support/index.html">Support</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/docs/index.html">Docs</a>
      <ul class="dropdown_menu dropdown_docs">
          <li><a href="/docs/faq/index.html">FAQ</a></li>
          <li><a href="/docs/guides/index.html">Guides</a></li>
          <li><a href="/docs/rex_book/index.html">Rex Book (work in progress)</a></li>
          <li><a href="/docs/release_notes/index.html">Release notes</a></li>
            <li class="divider"></li>
          <li><a href="https://metacpan.org/release/Rex">API</a></li>
      </ul>
    </li>
  </ul>
</div>

            </div>
            </div>
         </div>

         <div id="widgets_container">
            <div id="widgets">
               <h2>News</h2>
                   <p><b>2021-07-05</b><br>
                     <a href="/blog/2021/07/05/rex-1.13.4.html">Rex-1.13.4</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.13.4.html">Rex-1.13.4 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.13.4">available on CPAN</a>. It contains documentation updates, and a fix for inconsistent behavior between the <code>content</code> and <code>source</code> options of the file command.</p>

                   <p><b>2021-03-05</b><br>
                     <a href="/blog/2021/03/05/rex-1.13.3.html">Rex-1.13.3</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.13.3.html">Rex-1.13.3 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.13.3">available on CPAN</a>. It contains documentation updates, and a fix for debconf parsing. Behind the scenes, CI was migrated over to GitHub Actions as well.</p>

                   <p><b>2020-12-05</b><br>
                     <a href="/blog/2020/12/05/rex-1.13.2.html">Rex-1.13.2</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.13.2.html">Rex-1.13.2 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.13.2">available on CPAN</a>. It contains only documentation updates, mostly for the built-in template capabilities, but also fixes a few typos.</p>

                   <p><b>2020-11-05</b><br>
                     <a href="/blog/2020/11/05/rex-1.13.1.html">Rex-1.13.1</a></p><p>
                   </p><p></p><p><a href="https://github.com/RexOps/Rex/commit/cabbc6a8aa9eb2c0d9d3fc2439be51924edc3ff8">Happy 10th birthday, Rex!</a></p>

<p>The <a href="/docs/release_notes/1.13.1.html">Rex-1.13.1 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.13.1">available on CPAN</a>. It is focusing on CMDB bugfixes and documentation, while also fixing a missing feature flag. Upgrade is recommended for all users.</p>

                   <p><b>2020-10-05</b><br>
                     <a href="/blog/2020/10/05/rex-1.13.0.html">Rex-1.13.0</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.13.0.html">Rex-1.13.0 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.13.0">available on CPAN</a>. It adds <code>on_no_change</code> hooks for file management commands to trigger further actions when files are left unchanged. Upgrade is recommended for all users.</p>


               <h2>Events</h2>
                   <p><b>2021-03-08</b><br>
                     <a href="/blog/2021/03/04/learn_automation_using_rex.html">Learning automation using Rex</a></p><p>
                   </p><p></p><p>Ferenc Erki (FErki) will be the guest of <a href="https://www.linkedin.com/in/szabgab/">Gábor Szabó</a> on the next Code Maven live stream to learn about automation using Rex. Register for the free event via <a href="https://code-maven.com/automation-with-rex">Code Maven</a> or <a href="https://www.meetup.com/Code-Mavens/events/276730377/">Meetup</a>, and join the discussion!</p>

                   <p><b>2020-03-05</b><br>
                     <a href="/blog/2020/03/05/unexpected_use_cases_with_rex.html">Unexpected use cases with Rex</a></p><p>
                   </p><p></p><p><a href="https://act.yapc.eu/gpw2020/talk/7699">Unexpected use cases with Rex</a> at the <a href="https://act.yapc.eu/gpw2020/index.html">22nd German Perl/Raku Workshop 2020</a> in Erlangen by Ferenc Erki (FErki).</p>

                   <p><b>2019-11-09</b><br>
                     <a href="/blog/2019/11/09/rex_and_friends_2019.html">Rex &amp; Friends</a></p><p>
                   </p><p></p><p><a href="https://friends.barcelona.pm/2019/#/talks/rex-and-friends">Rex &amp; Friends</a> talk at the <a href="https://friends.barcelona.pm">Barcelona Perl &amp; Friends 2019</a> by Ferenc Erki (FErki).</p>


            </div>
         </div> <!-- widgets -->

         <div id="content_container">
            <div id="content">
                




<p>
» <a href="/index.html">Home</a>
» <a href="/docs/index.html">Docs</a>
» <a href="/docs/faq/index.html">FAQ</a>
</p>

              
              <h1>FAQ</h1>
              <p>Here we will maintain a list of frequently asked questions with their answers.</p>

<ul>
<li><a href="#isitcalledrexorrex">Is it called (R)?ex or Rex?</a></li>
<li><a href="#whydoestheruncommandnotformattheoutput">Why does the run command not format the output?</a></li>
<li><a href="#howcanigetthecurrentserverfromwithinatask">How can I get the current server from within a task?</a></li>
<li><a href="#howcanipassparameterstoatask">How can I pass parameters to a task?</a></li>
<li><a href="#howcanirunablockofcodewithonecommand">How can I run a block of code with one command?</a></li>
<li><a href="#howcanirunalocalscriptontheremote">How can I run a local script on the remote?</a></li>
<li><a href="#howdoirunalocalscriptontheremoteunderadifferentuser">How do I run a local script on the remote under a different user?</a></li>
<li><a href="#howdoichecktheexitstatusofaremotelyruncommand">How do I check the exit status of a remotely run command?</a></li>
<li><a href="#howdoiuserexsbuilt-inloggerforerrorwarninfodebugmessages">How do I use Rex&#39;s built-in logger for ERROR/WARN/INFO/DEBUG messages?</a></li>
<li><a href="#howdoiloadallmycustommoduleseasily">How do I load all my custom modules easily?</a></li>
<li><a href="#howdoiindicatethetaskfailedtorunproperly">How do I indicate the task failed to run properly?</a></li>
</ul>

<h2 id="isitcalledrexorrex">Is it called (R)?ex or Rex?</h2>

<p>Rex stands for <strong>R</strong>emote <strong>ex</strong>ecution. Both forms refer to the same thing: the friendly automation framework. Since automating tasks locally are just as fine as remotely, you can think of <code>(R)?ex</code> as a regular expression, marking the remote part optional.</p>

<h2 id="whydoestheruncommandnotformattheoutput">Why does the run command not format the output?</h2>

<p>The run command - called in array context - will return an array.</p>

<p>If you want to print the output to your terminal you have to call it in a scalar context.</p>

<pre><code class="hljs"><span class="hljs-keyword">my</span> <span class="hljs-type">$output</span> = run &quot;<span class="hljs-string">df -h</span>&quot;;
say <span class="hljs-type">$output</span>;</code></pre>

<h2 id="howcanigetthecurrentserverfromwithinatask">How can I get the current server from within a task?</h2>

<pre><code class="hljs"><span class="hljs-keyword">my</span> <span class="hljs-type">$current_server</span> = connection-&gt;server;</code></pre>

<h2 id="howcanipassparameterstoatask">How can I pass parameters to a task?</h2>

<pre><code class="hljs">task &#39;<span class="hljs-string">mytask</span>&#39;, <span class="hljs-keyword">sub </span>{
    <span class="hljs-keyword">my</span> <span class="hljs-type">$parameters</span>       = <span class="hljs-function">shift</span>;
    <span class="hljs-keyword">my</span> <span class="hljs-type">$parameter1_value</span> = <span class="hljs-type">$parameters</span>-&gt;{parameter1};
    <span class="hljs-keyword">my</span> <span class="hljs-type">$parameter2_value</span> = <span class="hljs-type">$parameters</span>-&gt;{parameter2};
};</code></pre>

<p>Then you can run <code>mytask</code> from CLI like this:</p>

<pre><code>rex -H hostname mytask --parameter1=value1 --parameter2=value2
</code></pre>

<p>Or from Rex code either using <a href="https://metacpan.org/pod/Rex::Commands#run_task">run_task</a>:</p>

<pre><code class="hljs">run_task &#39;<span class="hljs-string">my_task</span>&#39;,
  params =&gt; { parameter1 =&gt; &#39;<span class="hljs-string">value1</span>&#39;, parameter2 =&gt; &#39;<span class="hljs-string">value2</span>&#39; };</code></pre>

<p>or calling the task as a function:</p>

<pre><code class="hljs">mytask( { parameter1 =&gt; &#39;<span class="hljs-string">value1</span>&#39;, parameter2 =&gt; &#39;<span class="hljs-string">value2</span>&#39; } );</code></pre>

<h2 id="howcanirunablockofcodewithonecommand">How can I run a block of code with one command?</h2>

<p>One way to do it is to upload your script to the remote, and execute it there. You can use the <a href="https://github.com/RexOps/rex-recipes/tree/1.4/Rex/Misc/ShellBlock">Rex::Misc::ShellBlock</a> module for that. After copying it into one of the Perl include directories, or into <code>./lib</code> of your Rex project, you can run your shell code remotely as:</p>

<pre><code class="hljs"><span class="hljs-keyword">use</span> <span class="hljs-function">Rex::Misc</span>::<span class="hljs-function">ShellBlock</span>;

task &quot;<span class="hljs-string">myexec</span>&quot;, <span class="hljs-keyword">sub </span>{
    shell_block &lt;&lt;<span class="hljs-keyword">EOF;</span><span class="hljs-string">
</span><span class="hljs-string">    echo &quot;hi&quot;</span><span class="hljs-string">
</span><span class="hljs-keyword">EOF</span>
};</code></pre>

<p>See the included documentation of the module about how to use it to run code written in Perl, Python, or other languages.</p>

<h2 id="howcanirunalocalscriptontheremote">How can I run a local script on the remote?</h2>

<p>If you have a local script &#39;files/script&#39;, you can run it on the remote using the ShellBlock module referred to in the FAQ above. After you install as pointed out above, you can run the script remotely with the command:</p>

<pre><code class="hljs"><span class="hljs-keyword">use</span> <span class="hljs-function">Rex::Misc</span>::<span class="hljs-function">ShellBlock</span>;
task &quot;<span class="hljs-string">myexec</span>&quot;, <span class="hljs-keyword">sub </span>{
    shell_block template(&#39;<span class="hljs-string">files/script</span>&#39;);
};</code></pre>

<h2 id="howdoirunalocalscriptontheremoteunderadifferentuser">How do I run a local script on the remote under a different user?</h2>

<p>Given the same scenario as above, but with the additional requirement to run the script as a different user, the solution looks like below:</p>

<pre><code class="hljs"><span class="hljs-keyword">use</span> <span class="hljs-function">Rex::Misc</span>::<span class="hljs-function">ShellBlock</span>;
task &quot;<span class="hljs-string">myexec</span>&quot;, <span class="hljs-keyword">sub </span>{
    sudo {
        command =&gt; <span class="hljs-keyword">sub </span>{
            shell_block template(&#39;<span class="hljs-string">files/script</span>&#39;);
        },
        user =&gt; &#39;<span class="hljs-string">root</span>&#39;
    };
};</code></pre>

<h2 id="howdoichecktheexitstatusofaremotelyruncommand">How do I check the exit status of a remotely run command?</h2>

<p>Rex assigns the exit code from the remote invocation of <code>run</code> or <code>shell_block</code> statements to the <code>$?</code> variable.</p>

<h2 id="howdoiuserexsbuilt-inloggerforerrorwarninfodebugmessages">How do I use Rex&#39;s built-in logger for ERROR/WARN/INFO/DEBUG messages?</h2>

<pre><code class="hljs"><span class="hljs-function">Rex::Logger</span>::<span class="hljs-function">info</span>(&quot;<span class="hljs-string">some message</span>&quot;);            <span class="hljs-comment"># for INFO  (green)</span><span class="hljs-comment">
</span><span class="hljs-function">Rex::Logger</span>::<span class="hljs-function">info</span>( &quot;<span class="hljs-string">some message</span>&quot;, &quot;<span class="hljs-string">warn</span>&quot; );  <span class="hljs-comment"># for WARN  (yellow)</span><span class="hljs-comment">
</span><span class="hljs-function">Rex::Logger</span>::<span class="hljs-function">info</span>( &quot;<span class="hljs-string">some message</span>&quot;, &quot;<span class="hljs-string">error</span>&quot; ); <span class="hljs-comment"># for ERROR (red)</span></code></pre>

<h2 id="howdoiloadallmycustommoduleseasily">How do I load all my custom modules easily?</h2>

<p>There are plenty of CPAN modules providing this kind of functionality. For a comprehensive list and overview from some time ago, please read Neil Bowers&#39; article about <a href="http://neilb.org/reviews/module-loading.html">CPAN modules that (can) load other modules</a>.</p>

<p>Since Rex is just Perl, simply use one of them, like <a href="https://metacpan.org/pod/Module::Find">Module::Find</a> or <a href="https://metacpan.org/pod/Module::Pluggable">Module::Pluggable</a>.</p>

<p>This might affect when modules are loaded (e.g. at compilation time or at runtime), and/or in which order the modules are loaded. If you run into any troubles because of this, please make sure to specify the dependencies of the custom modules correctly.</p>

<h2 id="howdoiindicatethetaskfailedtorunproperly">How do I indicate the task failed to run properly?</h2>

<p>Overall, the same way as in Perl. For example, raising an exception with <code>die()</code> in the task body will abort the task, and calling <code>exit()</code> will bail out from the whole rex process currently running.</p>



            </div>
         </div> <!-- content -->

       <!-- page -->


   <div class="clearfix"></div>
   <div class="bottom_bar">
      <p>Proudly powered by <a href="http://preaction.me/statocles/">Statocles</a></p>
      <a href="https://github.com/RexOps/Rex">GitHub</a> / <a href="https://matrix.to/#rexops:matrix.org">Matrix</a> / <a href="https://webchat.oftc.net/?channels=rexops">IRC</a> / <a href="http://twitter.com/RexOps">Twitter</a> / <a href="https://groups.google.com/group/rex-users/">Google Groups</a> / <a href="https://stackshare.io/rex">StackShare</a> / <a href="http://www.freelists.org/list/rex-users">Mailing list</a> / <a href="http://serverfault.com/questions/tagged/rex">Server Fault</a>   -.ô.-   <a href="http://www.disclaimer.de/disclaimer.htm" target="_blank">Disclaimer</a>
   </div>

   </body>

</html>
