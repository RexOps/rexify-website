<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html prefix="og: http://ogp.me/ns#" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta content="text/html; charset=utf-8" http-equiv="content-type">

      <title>Getting information of the environment</title>

      <meta content="Getting information of the environment" property="og:title">
      <meta content="website" property="og:type">
      <meta content="https://rexify.org/docs/rex_book/writing_modules/getting_information_of_the_environment.html" property="og:url">
      <meta content="https://rexify.org/public/images/skin/rexify.org/open_graph.png" property="og:image">

      <meta content="width=1024, initial-scale=0.5" name="viewport">
      <link href="/public/images/skin/rexify.org/favicon.png" rel="shortcut icon">
      <link href="/public/css/skin/rexify.org/hs/tomorrow.css" rel="stylesheet">
      <link charset="utf-8" href="/public/css/skin/rexify.org/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css">
      <link charset="utf-8" href="/public/css/skin/rexify.org/default.css" media="screen" rel="stylesheet" type="text/css">
      <meta content="" name="description">
      <meta content="" name="keywords">

   </head>
   <body>

      <div id="page">

         <div class="top_div" id="top-div">
            <h1>(R)?ex <small>the friendly automation framework</small></h1>
            <div id="nav-div">
               
<div class="nav_links">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/get/index.html">Get Rex</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/care/index.html">Care</a>
      <ul class="dropdown_menu dropdown_care">
          <li><a href="/care/help__r__ex.html">Help (R)?ex</a></li>
          <li><a href="/care/help_people_in_need.html">Help people</a></li>
      </ul>
    </li>
    <li><a href="/support/index.html">Support</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/docs/index.html">Docs</a>
      <ul class="dropdown_menu dropdown_docs">
          <li><a href="/docs/faq/index.html">FAQ</a></li>
          <li><a href="/docs/guides/index.html">Guides</a></li>
          <li><a href="/docs/rex_book/index.html">Rex Book (work in progress)</a></li>
          <li><a href="/docs/release_notes/index.html">Release notes</a></li>
            <li class="divider"></li>
          <li><a href="https://metacpan.org/release/Rex">API</a></li>
      </ul>
    </li>
  </ul>
</div>

            </div>
            </div>
         </div>

         <div id="widgets_container">
            <div id="widgets">
               <h2>News</h2>
                   <p><b>2023-05-05</b><br>
                     <a href="/blog/2023/05/05/rex-1.14.2.html">Rex-1.14.2</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.14.2.html">Rex-1.14.2 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.14.2">available on CPAN</a>. It contains bug fixes for running local commands on Windows, cloning git repositories, and test suite fixes for the upcoming perl-5.38.0 release.</p>

                   <p><b>2023-03-17</b><br>
                     <a href="/blog/2023/03/17/call-for-papers-tprc-2023.html">Call for papers TPRC 2023</a></p><p>
                   </p><p></p><p>Dean Hamstead from the The Perl and Raku Foundation Marketing Committee has sent an <a href="https://www.freelists.org/post/rex-users/Call-for-Papers-Talks-TPRC-2023">invitation to present about Rex at TPRC 2023</a>. I’m posting it here to increase visibility.</p>

                   <p><b>2023-03-05</b><br>
                     <a href="/blog/2023/03/05/rex-1.14.1.html">Rex-1.14.1</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.14.1.html">Rex-1.14.1 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.14.1">available on CPAN</a>. It contains bug fixes and documentation updates.</p>

                   <p><b>2023-02-05</b><br>
                     <a href="/blog/2023/02/05/rex-1.14.0.html">Rex-1.14.0</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.14.0.html">Rex-1.14.0 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.14.0">available on CPAN</a>. It contains improved Rexfile loading, documentation updates, and bumps the minimum required Perl version to 5.12.5.</p>

                   <p><b>2021-07-05</b><br>
                     <a href="/blog/2021/07/05/rex-1.13.4.html">Rex-1.13.4</a></p><p>
                   </p><p></p><p>The <a href="/docs/release_notes/1.13.4.html">Rex-1.13.4 release</a> is now <a href="https://metacpan.org/release/FERKI/Rex-1.13.4">available on CPAN</a>. It contains documentation updates, and a fix for inconsistent behavior between the <code>content</code> and <code>source</code> options of the file command.</p>


               <h2>Events</h2>
                   <p><b>2021-03-08</b><br>
                     <a href="/blog/2021/03/04/learn_automation_using_rex.html">Learning automation using Rex</a></p><p>
                   </p><p></p><p>Ferenc Erki (FErki) will be the guest of <a href="https://www.linkedin.com/in/szabgab/">Gábor Szabó</a> on the next Code Maven live stream to learn about automation using Rex. Register for the free event via <a href="https://code-maven.com/automation-with-rex">Code Maven</a> or <a href="https://www.meetup.com/Code-Mavens/events/276730377/">Meetup</a>, and join the discussion!</p>

                   <p><b>2020-03-05</b><br>
                     <a href="/blog/2020/03/05/unexpected_use_cases_with_rex.html">Unexpected use cases with Rex</a></p><p>
                   </p><p></p><p><a href="https://act.yapc.eu/gpw2020/talk/7699">Unexpected use cases with Rex</a> at the <a href="https://act.yapc.eu/gpw2020/index.html">22nd German Perl/Raku Workshop 2020</a> in Erlangen by Ferenc Erki (FErki).</p>

                   <p><b>2019-11-09</b><br>
                     <a href="/blog/2019/11/09/rex_and_friends_2019.html">Rex &amp; Friends</a></p><p>
                   </p><p></p><p><a href="https://friends.barcelona.pm/2019/#/talks/rex-and-friends">Rex &amp; Friends</a> talk at the <a href="https://friends.barcelona.pm">Barcelona Perl &amp; Friends 2019</a> by Ferenc Erki (FErki).</p>


            </div>
         </div> <!-- widgets -->

         <div id="content_container">
            <div id="content">
                




<p>
» <a href="/index.html">Home</a>
» <a href="/docs/index.html">Docs</a>
» <a href="/docs/rex_book/index.html">Rex book</a>
» <a href="/docs/rex_book/writing_modules/index.html">Writing modules</a>
» <a href="/docs/rex_book/writing_modules/getting_information_of_the_environment.html">Getting information of the environment</a>
</p>

              
              <h1>Getting information of the environment</h1>
              <p>Often you need to know some things of the environment where you are currently connected. For example if you need to install apache on Debian and CentOS you have to provide different packages names.</p>

<p>Rex comes with a hardware gathering module. To display all the things Rex knows about the environment your can create a test task that just dumps all the information.</p>

<pre><code class="hljs">use Rex -feature =&gt; [&#39;<span class="hljs-string">1.0</span>&#39;];

task &quot;<span class="hljs-string">dump-info</span>&quot;, <span class="hljs-keyword">sub </span>{
    dump_system_information;
};</code></pre>

<p>This will print out everything Rex knows about the remote system. You can use these information inside your Rexfile or a template.</p>

<p>A sample output (CentOS 5.9 running inside KVM)</p>

<pre><code>$kernelversion = &#39;#1 SMP Tue May 21 15:29:55 EDT 2013&#39;
$memory_cached = &#39;127&#39;
$memory_total = &#39;497&#39;
$kernelrelease = &#39;2.6.18-348.6.1.el5&#39;
$Kernel = {
      kernelversion =&gt; &#39;#1 SMP Tue May 21 15:29:55 EDT 2013&#39;
      architecture =&gt; &#39;x86_64&#39;
      kernel =&gt; &#39;Linux&#39;
      kernelrelease =&gt; &#39;2.6.18-348.6.1.el5&#39;
   }
$hostname = &#39;centos-5-amd64.rexify.org&#39;
$operatingsystem = &#39;CentOS&#39;
$operatingsystemrelease = &#39;5.9&#39;
$architecture = &#39;x86_64&#39;
$domain = &#39;&#39;
$eth0_mac = &#39;52:54:00:E8:69:15&#39;
$kernel = &#39;Linux&#39;
$swap_free = &#39;1023&#39;
$VirtInfo = {
      virtualization_role =&gt; &#39;guest&#39;
      virtualization_type =&gt; &#39;kvm&#39;
   }
$memory_shared = &#39;0&#39;
$Network = {
      networkdevices =&gt; [
         &#39;eth0&#39;
      ]
      networkconfiguration =&gt; {
         eth0 =&gt; {
            broadcast =&gt; &#39;192.168.122.255&#39;
            ip =&gt; &#39;192.168.122.22&#39;
            netmask =&gt; &#39;255.255.255.0&#39;
            mac =&gt; &#39;52:54:00:E8:69:15&#39;
         }
      }
   }
$memory_used = &#39;218&#39;
$kernelname = &#39;Linux&#39;
$Swap = {
      free =&gt; &#39;1023&#39;
      used =&gt; &#39;0&#39;
      total =&gt; &#39;1023&#39;
   }
$swap_total = &#39;1023&#39;
$memory_buffers = &#39;12&#39;
$eth0_ip = &#39;192.168.122.22&#39;
$swap_used = &#39;0&#39;
$memory_free = &#39;278&#39;
$manufacturer = &#39;Bochs&#39;
$Memory = {
      shared =&gt; &#39;0&#39;
      buffers =&gt; &#39;12&#39;
      free =&gt; &#39;278&#39;
      used =&gt; &#39;218&#39;
      total =&gt; &#39;497&#39;
      cached =&gt; &#39;127&#39;
   }
$eth0_broadcast = &#39;192.168.122.255&#39;
$eth0_netmask = &#39;255.255.255.0&#39;
$Host = {
      domain =&gt; &#39;&#39;
      manufacturer =&gt; &#39;Bochs&#39;
      kernelname =&gt; &#39;Linux&#39;
      hostname =&gt; &#39;centos-5-amd64.rexify.org&#39;
      operatingsystemrelease =&gt; &#39;5.9&#39;
      operatingsystem =&gt; &#39;CentOS&#39;
   }
</code></pre>

<p>To use these information inside the Rexfile you can query them with the get_system_information function or use the methods from the connection object</p>

<pre><code class="hljs"><span class="hljs-keyword">use</span> Rex -feature =&gt; [&#39;<span class="hljs-string">1.0</span>&#39;];

task &quot;<span class="hljs-string">get_hostname</span>&quot;, <span class="hljs-keyword">sub </span>{
    <span class="hljs-keyword">my</span> <span class="hljs-type">%info</span> = get_system_information;
    say <span class="hljs-type">$info</span>{hostname} . &quot;<span class="hljs-string">.</span>&quot; . <span class="hljs-type">$info</span>{domain};
};

<span class="hljs-keyword">use</span> Rex -feature =&gt; [&#39;<span class="hljs-string">1.0</span>&#39;];

task &quot;<span class="hljs-string">prepare</span>&quot;, <span class="hljs-keyword">sub </span>{
    <span class="hljs-keyword">my</span> <span class="hljs-type">$libpath</span> = case connection-&gt;server-&gt;architecture,
      &quot;<span class="hljs-string">i386</span>&quot;   =&gt; &quot;<span class="hljs-string">/usr/lib</span>&quot;,
      &quot;<span class="hljs-string">x86_64</span>&quot; =&gt; &quot;<span class="hljs-string">/usr/lib64</span>&quot;;
};</code></pre>

<h2 id="usingenvironmentinformationinsidetemplates">Using environment information inside templates</h2>

<p>You can also use these information inside your template. For example if you want to add the ip address of eth0 or the hostname into a file or change settings of an application based on memory size.</p>

<pre><code>Listen &lt;%= $eth0_ip %&gt;:80
</code></pre>



            </div>
         </div> <!-- content -->

       <!-- page -->


   <div class="clearfix"></div>
   <div class="bottom_bar">
      <p>Proudly powered by <a href="https://www.perl.org/">Perl</a> and built with <a href="http://preaction.me/statocles/">Statocles</a></p>
      <p>GitHub <a href="https://github.com/RexOps/Rex">repository</a> and <a href="https://github.com/RexOps/Rex/discussions">discussions</a> / Chat on <a href="https://matrix.to/#/#rexops:matrix.org">Matrix</a> and <a href="https://webchat.oftc.net/?channels=rexops">IRC</a> / Mailing list on <a href="https://groups.google.com/group/rex-users/">Google Groups</a> (retired: <a href="http://www.freelists.org/list/rex-users">rex-users@freelists</a>)</p>
      <p><a href="https://metacpan.org/dist/Rex">MetaCPAN</a> / <a href="http://twitter.com/RexOps">Twitter</a> / <a href="https://stackshare.io/rex">StackShare</a> / <a href="http://serverfault.com/questions/tagged/rex">Server Fault</a>   -.ô.-   <a href="http://www.disclaimer.de/disclaimer.htm" target="_blank">Disclaimer</a></p>
   </div>

   </body>

</html>
