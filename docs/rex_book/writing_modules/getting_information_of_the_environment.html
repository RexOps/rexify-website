<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta content="text/html; charset=utf-8" http-equiv="content-type">

      <title>Getting information of the environment</title>

      <meta content="width=1024, initial-scale=0.5" name="viewport">
      <link href="/rexify-website/public/images/skin/rexify.org/favicon.png" rel="shortcut icon">
      <link href="/rexify-website/public/css/skin/rexify.org/hs/tomorrow.css" rel="stylesheet">
      <link charset="utf-8" href="/rexify-website/public/css/skin/rexify.org/bootstrap.min.css?20130325" media="screen" rel="stylesheet" type="text/css">
      <link charset="utf-8" href="/rexify-website/public/css/skin/rexify.org/default.css?20140412" media="screen" rel="stylesheet" type="text/css">
      <script src="/rexify-website/public/js/skin/rexify.org/highlight.pack.js"></script>
      <meta content="" name="description">
      <meta content="" name="keywords">

   </head>
   <body>

      <div id="page">

         <div class="top_div" id="top-div">
            <h1>(R)?ex <small>Deployment &amp; Configuration Management</small></h1>
            <div id="nav-div">
               
<div class="nav_links">
  <ul>
    <li><a href="/rexify-website/">Home</a></li>
    <li><a href="/rexify-website/get/index.html">Get Rex</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/rexify-website/care/index.html" title="care">Care</a>
      <ul class="dropdown_menu dropdown_care">
          <li><a href="/rexify-website/care/help__r__ex.html">Help (R)?ex</a></li>
          <li><a href="/rexify-website/care/help_people_in_need.html">Help people</a></li>
      </ul>
    </li>
    <li><a href="/rexify-website/support/index.html">Support</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/rexify-website/docs/index.html" title="docs">Docs</a>
      <ul class="dropdown_menu dropdown_docs">
          <li><a href="/rexify-website/docs/faq/index.html">FAQ</a></li>
          <li><a href="/rexify-website/docs/guides/index.html">Guides</a></li>
          <li><a href="/rexify-website/docs/rex_book/index.html">Rex Book (work in progress)</a></li>
          <li><a href="/rexify-website/docs/other/index.html">Other</a></li>
          <li><a href="/rexify-website/docs/release_notes/index.html">Release notes</a></li>
            <li class="divider"></li>
          <li><a href="/rexify-website/docs/api/index.html">API</a></li>
      </ul>
    </li>
  </ul>
</div>

            </div>
            </div>
         </div>

         <div id="widgets_container">
            <div id="widgets">
               <h2>Conferences</h2>
                 <div class="news_widget">
                    <div class="news_date">2016-06-21</div>
                    <div class="news_content"><a href="http://preaction.me/">Doug Bell (preaction)</a> from <a href="http://chicago.pm.org/">Chicago.pm</a> will give an <a href="http://www.yapcna.org/yn2016/talk/6549">Introduction to Rex</a> talk at <a href="http://www.yapcna.org/yn2016/">YAPC::NA 2016</a>.</div>
                 </div>

               <h2>Need Help?</h2>
               <p>Rex is a pure open source project, you can find community support in the following places:</p>
               <ul>
                  <li>IRC: <a href="irc://irc.freenode.net/rex">#rex on irc.freenode.net</a></li>
                  <li>Groups: <a href="https://groups.google.com/group/rex-users/">Rex Users</a></li>
                  <li>Serverfault: <a href="http://serverfault.com/questions/tagged/rex">Tag with <i>rex</i></a></li>
                  <li>Issues: <a href="https://github.com/RexOps/Rex/issues">on GitHub</a></li>
                  <li>Feature: you miss a <a href="/rexify-website/feature.html">feature</a>?</li>
               </ul>
               <p><a href="/rexify-website/support/index.html">Professional support</a> is also available.</p>
            </div>
         </div> <!-- widgets -->

         <div id="content_container">
            <div id="content">
              




<p>
» <a href="/rexify-website/index.html">Home</a>
» <a href="/rexify-website/docs/index.html">Docs</a>
» <a href="/rexify-website/docs/rex_book/index.html">Rex book</a>
» <a href="/rexify-website/docs/rex_book/writing_modules/index.html">Writing modules</a>
» <a href="/rexify-website/docs/rex_book/writing_modules/getting_information_of_the_environment.html">Getting information of the environment</a>
</p>

              
              <h1>Getting information of the environment</h1>
              <p>Often you need to know some things of the environment where you are currently connected. For example if you need to install apache on Debian and CentOS you have to provide different packages names.</p>

<p>Rex comes with a hardware gathering module. To display all the things Rex knows about the environment your can create a test task that just dumps all the information.</p>

<pre><code>use Rex -feature =&gt; [&#39;1.0&#39;];

task &quot;dump-info&quot;, sub {
   dump_system_information;
};
</code></pre>

<p>This will print out everything Rex knows about the remote system. You can use these information inside your Rexfile or a template.</p>

<p>A sample output (CentOS 5.9 running inside KVM)</p>

<pre><code>$kernelversion = &#39;#1 SMP Tue May 21 15:29:55 EDT 2013&#39;
$memory_cached = &#39;127&#39;
$memory_total = &#39;497&#39;
$kernelrelease = &#39;2.6.18-348.6.1.el5&#39;
$Kernel = {
      kernelversion =&gt; &#39;#1 SMP Tue May 21 15:29:55 EDT 2013&#39;
      architecture =&gt; &#39;x86_64&#39;
      kernel =&gt; &#39;Linux&#39;
      kernelrelease =&gt; &#39;2.6.18-348.6.1.el5&#39;
   }
$hostname = &#39;centos-5-amd64.rexify.org&#39;
$operatingsystem = &#39;CentOS&#39;
$operatingsystemrelease = &#39;5.9&#39;
$architecture = &#39;x86_64&#39;
$domain = &#39;&#39;
$eth0_mac = &#39;52:54:00:E8:69:15&#39;
$kernel = &#39;Linux&#39;
$swap_free = &#39;1023&#39;
$VirtInfo = {
      virtualization_role =&gt; &#39;guest&#39;
      virtualization_type =&gt; &#39;kvm&#39;
   }
$memory_shared = &#39;0&#39;
$Network = {
      networkdevices =&gt; [
         &#39;eth0&#39;
      ]
      networkconfiguration =&gt; {
         eth0 =&gt; {
            broadcast =&gt; &#39;192.168.122.255&#39;
            ip =&gt; &#39;192.168.122.22&#39;
            netmask =&gt; &#39;255.255.255.0&#39;
            mac =&gt; &#39;52:54:00:E8:69:15&#39;
         }
      }
   }
$memory_used = &#39;218&#39;
$kernelname = &#39;Linux&#39;
$Swap = {
      free =&gt; &#39;1023&#39;
      used =&gt; &#39;0&#39;
      total =&gt; &#39;1023&#39;
   }
$swap_total = &#39;1023&#39;
$memory_buffers = &#39;12&#39;
$eth0_ip = &#39;192.168.122.22&#39;
$swap_used = &#39;0&#39;
$memory_free = &#39;278&#39;
$manufacturer = &#39;Bochs&#39;
$Memory = {
      shared =&gt; &#39;0&#39;
      buffers =&gt; &#39;12&#39;
      free =&gt; &#39;278&#39;
      used =&gt; &#39;218&#39;
      total =&gt; &#39;497&#39;
      cached =&gt; &#39;127&#39;
   }
$eth0_broadcast = &#39;192.168.122.255&#39;
$eth0_netmask = &#39;255.255.255.0&#39;
$Host = {
      domain =&gt; &#39;&#39;
      manufacturer =&gt; &#39;Bochs&#39;
      kernelname =&gt; &#39;Linux&#39;
      hostname =&gt; &#39;centos-5-amd64.rexify.org&#39;
      operatingsystemrelease =&gt; &#39;5.9&#39;
      operatingsystem =&gt; &#39;CentOS&#39;
   }
</code></pre>

<p>To use these information inside the Rexfile you can query them with the get_system_information function or use the methods from the connection object</p>

<pre><code>use Rex -feature =&gt; [&#39;1.0&#39;];

task &quot;get_hostname&quot;, sub {
   my %info = get_system_information;
   say $info{hostname} . &quot;.&quot; . $info{domain};
};

use Rex -feature =&gt; [&#39;1.0&#39;];

task &quot;prepare&quot;, sub {
   my $libpath = case connection-&gt;server-&gt;architecture,
                     &quot;i386&quot;   =&gt; &quot;/usr/lib&quot;,
                     &quot;x86_64&quot; =&gt; &quot;/usr/lib64&quot;;
};
</code></pre>

<h2 id="usingenvironmentinformationinsidetemplates">Using environment information inside templates</h2>

<p>You can also use these information inside your template. For example if you want to add the ip address of eth0 or the hostname into a file or change settings of an application based on memory size.</p>

<pre><code>Listen &lt;%= $eth0_ip %&gt;:80
</code></pre>



            </div>
         </div> <!-- content -->

       <!-- page -->


     <a href="http://github.com/RexOps/Rex"><img alt="Fork me on GitHub" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" style="position: absolute; top: 0; right: 0; border: 0;"></a>

   <div class="clearfix"></div>
   <div class="bottom_bar">
      <a href="https://groups.google.com/group/rex-users/">Google Group</a> / <a href="http://twitter.com/RexOps">Twitter</a> / <a href="https://github.com/RexOps/Rex">GitHub</a> / <a href="http://www.freelists.org/list/rex-users">Mailinglist</a> / <a href="irc://irc.freenode.net/rex">irc.freenode.net #rex</a><span id="syntax_high" style="display: none;"> / <a href="#" id="link_syntax_high">Enable Syntax Highlighting</a></span>   -.ô.-   <a href="http://www.disclaimer.de/disclaimer.htm" target="_blank">Disclaimer</a>
   </div>

   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/jquery.js" type="text/javascript"></script>
   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/bootstrap.min.js" type="text/javascript"></script>
   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/menu.js" type="text/javascript"></script>
   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/ZeroClipboard.min.js" type="text/javascript"></script>

   <script>
      var client = new ZeroClipboard($(".copy-button"), { moviePath: "/public/js/skin/rexify.org/ZeroClipboard.swf"});
   </script>

   <script>
      if($(window).width() <= 1100) {
         // hide API link
         $("#li_api").hide();
      }
      $(window).on('resize', function() {
       if($(window).width() <= 1100) {
         // hide API link
         $("#li_api").hide();
       }
       else {
         $("#li_api").show();
       }

      });
   </script>


<script src="/rexify-website/public/js/skin/rexify.org/browser.js"></script>
<script>
  hljs.tabReplace = '    ';
//  hljs.initHighlighting();
  hljs.initHighlightingOnLoad();
</script>


   </body>

</html>
