<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta content="text/html; charset=utf-8" http-equiv="content-type">

      <title>CMDB.pm</title>

      <meta content="width=1024, initial-scale=0.5" name="viewport">
      <link href="/rexify-website/public/images/skin/rexify.org/favicon.png" rel="shortcut icon">
      <link href="/rexify-website/public/css/skin/rexify.org/hs/tomorrow.css" rel="stylesheet">
      <link charset="utf-8" href="/rexify-website/public/css/skin/rexify.org/bootstrap.min.css?20130325" media="screen" rel="stylesheet" type="text/css">
      <link charset="utf-8" href="/rexify-website/public/css/skin/rexify.org/default.css?20140412" media="screen" rel="stylesheet" type="text/css">
      <script src="/rexify-website/public/js/skin/rexify.org/highlight.pack.js"></script>

      <meta content="" name="description">
      <meta content="" name="keywords">

   </head>
   <body>

      <div id="page">

         <div class="top_div" id="top-div">
            <h1>(R)?ex <small>Deployment &amp; Configuration Management</small></h1>
            <div id="nav-div">
               
<div class="nav_links">
  <ul>
    <li><a href="/rexify-website/">Home</a></li>
    <li><a href="/rexify-website/get/index.html">Get Rex</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/rexify-website/care/index.html" title="care">Care</a>
      <ul class="dropdown_menu dropdown_care">
          <li><a href="/rexify-website/care/help__r__ex.html">Help (R)?ex</a></li>
          <li><a href="/rexify-website/care/help_people_in_need.html">Help people</a></li>
      </ul>
    </li>
    <li><a href="/rexify-website/support/index.html">Support</a></li>
    <li>
      <b class="arrow_box"></b>
      <a class="dropdown_link" href="/rexify-website/docs/index.html" title="docs">Docs</a>
      <ul class="dropdown_menu dropdown_docs">
          <li><a href="/rexify-website/docs/faq/index.html">FAQ</a></li>
          <li><a href="/rexify-website/docs/guides/index.html">Guides</a></li>
          <li><a href="/rexify-website/docs/rex_book/index.html">Rex Book (work in progress)</a></li>
          <li><a href="/rexify-website/docs/other/index.html">Other</a></li>
          <li><a href="/rexify-website/docs/release_notes/index.html">Release notes</a></li>
            <li class="divider"></li>
          <li><a href="/rexify-website/docs/api/index.html">API</a></li>
      </ul>
    </li>
  </ul>
</div>

            </div>
            </div>
         </div>

         <div id="widgets_container">
            <div id="widgets">
               <h2>Conferences</h2>
                 <div class="news_widget">
                    <div class="news_date">2016-06-21</div>
                    <div class="news_content"><a href="http://preaction.me/">Doug Bell (preaction)</a> from <a href="http://chicago.pm.org/">Chicago.pm</a> will give an <a href="http://www.yapcna.org/yn2016/talk/6549">Introduction to Rex</a> talk at <a href="http://www.yapcna.org/yn2016/">YAPC::NA 2016</a>.</div>
                 </div>

               <h2>Need Help?</h2>
               <p>Rex is a pure open source project, you can find community support in the following places:</p>
               <ul>
                  <li>IRC: <a href="irc://irc.freenode.net/rex">#rex on irc.freenode.net</a></li>
                  <li>Groups: <a href="https://groups.google.com/group/rex-users/">Rex Users</a></li>
                  <li>Serverfault: <a href="http://serverfault.com/questions/tagged/rex">Tag with <i>rex</i></a></li>
                  <li>Issues: <a href="https://github.com/RexOps/Rex/issues">on GitHub</a></li>
                  <li>Feature: you miss a <a href="/rexify-website/feature.html">feature</a>?</li>
               </ul>
               <p><a href="/rexify-website/support/index.html">Professional support</a> is also available.</p>
            </div>
         </div> <!-- widgets -->

         <div id="content_container">
            <div id="content">
              




<p>
» <a href="/rexify-website/index.html">Home</a>
» <a href="/rexify-website/docs/index.html">Docs</a>
» <a href="/rexify-website/docs/api/index.html">Api</a>
» <a href="/rexify-website/docs/api/1.3/index.html">1.3</a>
» <a href="/rexify-website/docs/api/1.3/rex/index.html">Rex</a>
» <a href="/rexify-website/docs/api/1.3/rex/cmdb.pm.html">CMDB.pm</a>
</p>

              
              <h1>CMDB.pm</h1>
              <ul>
<li><a href="#NAME">NAME</a></li>
<li><a href="#DESCRIPTION">DESCRIPTION</a></li>
<li><a href="#SYNOPSIS">SYNOPSIS</a></li>
<li><a href="#EXPORTED-FUNCTIONS">EXPORTED FUNCTIONS</a>
<ul>
<li><a href="#set-cmdb">set cmdb</a></li>
<li><a href="#cmdb-item-server-">cmdb([$item, $server])</a></li>
</ul></li>
</ul>

<h1 id="name">NAME</h1>

<p>Rex::CMDB - Function to access the CMDB (configuration management database)</p>

<h1 id="description">DESCRIPTION</h1>

<p>This module exports a function to access a CMDB via a common interface.</p>

<h1 id="synopsis">SYNOPSIS</h1>

<pre><code> use Rex::CMDB;

 set cmdb =&gt; {
     type =&gt; &#39;YAML&#39;,
     path =&gt; [ 
         &#39;cmdb/{hostname}.yml&#39;,
         &#39;cmdb/default.yml&#39;,
     ],
     merge_behavior =&gt; &#39;LEFT_PRECEDENT&#39;,
 };

 task &quot;prepare&quot;, &quot;server1&quot;, sub {
   my $virtual_host = cmdb(&quot;vhost&quot;);
   my %all_information = cmdb;
 };
</code></pre>

<h1 id="exportedfunctions">EXPORTED FUNCTIONS</h1>

<h2 id="setcmdb">set cmdb</h2>

<p>CMDB is enabled by default, with Rex::CMDB::YAML as default provider.</p>

<p>The path option specifies an ordered list of places to look for CMDB information. The path specification supports any Rex::Hardware variable as macros, when enclosed within curly braces. Macros are dynamically expanded during runtime. The default path settings is:</p>

<pre><code> [qw(
     cmdb/{operatingsystem}/{hostname}.yml
     cmdb/{operatingsystem}/default.yml
     cmdb/{environment}/{hostname}.yml
     cmdb/{environment}/default.yml
     cmdb/{hostname}.yml
     cmdb/default.yml
 )]
</code></pre>

<p>Please note that the default environment is, well, &quot;default&quot;.</p>

<p>You can define additional CMDB paths via the `-O` command line option by using a semicolon-separated list of `cmdb_path=path` key-value pairs:</p>

<pre><code> rex -O &#39;cmdb_path=cmdb/{domain}.yml;cmdb_path=cmdb/{domain}/{hostname}.yml;&#39; taskname
</code></pre>

<p>Those additional paths will be prepended to the current list of CMDB paths (so the last one specified will get on top, and thus checked first).</p>

<p>The CMDB module looks up the specified files in order and then returns the requested data. If multiple files specify the same data for a given case, then the first instance of the data will be returned by default.</p>

<p>Rex uses Hash::Merge internally to merge the data found on different levels of the CMDB hierarchy. Any merge strategy supported by that module can be specified to override the default one. For example one of the built-in strategies:</p>

<pre><code> merge_behavior =&gt; &#39;LEFT_PRECEDENT&#39;
</code></pre>

<p>Or even custom ones:</p>

<pre><code> merge_behavior =&gt; {
     SCALAR =&gt; { ... },
     ARRAY  =&gt; { ... },
     HASH   =&gt; { ... },
 }
</code></pre>

<p>For full list of options, please see the documentation of Hash::Merge.</p>

<h2 id="cmdbitemserver">cmdb([$item, $server])</h2>

<p>Function to query a CMDB. If this function is called without $item it should return a hash containing all the information for the requested server. If $item is given it should return only the value for $item.</p>

<pre><code> task &quot;prepare&quot;, &quot;server1&quot;, sub {
   my $virtual_host = cmdb(&quot;vhost&quot;);
   my %all_information = cmdb;
 };
</code></pre>



            </div>
         </div> <!-- content -->

       <!-- page -->


     <a href="http://github.com/RexOps/Rex"><img alt="Fork me on GitHub" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" style="position: absolute; top: 0; right: 0; border: 0;"></a>

   <div class="clearfix"></div>
   <div class="bottom_bar">
      <a href="https://groups.google.com/group/rex-users/">Google Group</a> / <a href="http://twitter.com/RexOps">Twitter</a> / <a href="https://github.com/RexOps/Rex">GitHub</a> / <a href="http://www.freelists.org/list/rex-users">Mailinglist</a> / <a href="irc://irc.freenode.net/rex">irc.freenode.net #rex</a><span id="syntax_high" style="display: none;"> / <a href="#" id="link_syntax_high">Enable Syntax Highlighting</a></span>   -.ô.-   <a href="http://www.disclaimer.de/disclaimer.htm" target="_blank">Disclaimer</a>
   </div>

   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/jquery.js" type="text/javascript"></script>
   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/bootstrap.min.js" type="text/javascript"></script>
   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/menu.js" type="text/javascript"></script>
   <script charset="utf-8" src="/rexify-website/public/js/skin/rexify.org/ZeroClipboard.min.js" type="text/javascript"></script>

   <script>
      var client = new ZeroClipboard($(".copy-button"), { moviePath: "/public/js/skin/rexify.org/ZeroClipboard.swf"});
   </script>

   <script>
      if($(window).width() <= 1100) {
         // hide API link
         $("#li_api").hide();
      }
      $(window).on('resize', function() {
       if($(window).width() <= 1100) {
         // hide API link
         $("#li_api").hide();
       }
       else {
         $("#li_api").show();
       }

      });
   </script>


<script src="/rexify-website/public/js/skin/rexify.org/browser.js"></script>
<script>
  hljs.tabReplace = '    ';
//  hljs.initHighlighting();
  hljs.initHighlightingOnLoad();
</script>


   </body>

</html>
